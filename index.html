<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>stamp rally</title>
    <script src="scripts/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
    <script src="scripts/aframe-extras.min.js"></script>
  </head>

  <body style="margin: 0px; overflow: hidden;">
    <a-scene device-orientation-permission-ui="enabled: false">
      <a-entity
        id="model1"
        gltf-model="1DeerExport.glb"
        look-at="[camera]"
        scale="1 1 1"
        position="0 -1.8 -2.8"
        animation-mixer
      ></a-entity>
      <a-entity
        id="model2"
        gltf-model="2ElephantExport.glb"
        look-at="[camera]"
        scale="0.85 0.85 0.85"
        position="0 -1.5 -3"
        animation-mixer
      ></a-entity>
      <a-entity
        id="model3"
        gltf-model="3GiraffeExport.glb"
        look-at="[camera]"
        scale="0.83 0.83 0.83"
        position="0 -2 -3.2"
        animation-mixer
      ></a-entity>
      <a-entity
        id="model4"
        gltf-model="4LionExport.glb"
        look-at="[camera]"
        scale="1 1 1"
        position="0 -2 -3.5"
        animation-mixer
      ></a-entity>
      <a-entity
        id="model5"
        gltf-model="5ZebraExport.glb"
        look-at="[camera]"
        scale="1 1 1"
        position="0 -1.8 -3.5"
        animation-mixer
      ></a-entity>
      <a-entity camera></a-entity>
    </a-scene>
    <a-scene
      id="a-scene"
      mindar-image="imageTargetSrc: trackers/targets.mind; uiError:no; uiScanning:no"
      device-orientation-permission-ui="enabled: false"
    >
      <a-entity id="target1" mindar-image-target="targetIndex: 0"></a-entity>
      <a-entity id="target2" mindar-image-target="targetIndex: 1"></a-entity>
      <a-entity id="target3" mindar-image-target="targetIndex: 2"></a-entity>
      <a-entity id="target4" mindar-image-target="targetIndex: 3"></a-entity>
      <a-entity id="target5" mindar-image-target="targetIndex: 4"></a-entity>
      <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>
    </a-scene>
    <script>
      let model1 = document.getElementById("model1");
      let model2 = document.getElementById("model2");
      let model3 = document.getElementById("model3");
      let model4 = document.getElementById("model4");
      let model5 = document.getElementById("model5");
      let target1 = document.querySelector("#target1");
      let target2 = document.querySelector("#target2");
      let target3 = document.querySelector("#target3");
      let target4 = document.querySelector("#target4");
      let target5 = document.querySelector("#target5");
      const toggleVisible = (el, visible) => {
        el.setAttribute("visible", visible);
        //el.setAttribute("animation-mixer", { timeScale: visible ? 1 : 0});
        if (visible == false) {
          el.removeAttribute("animation-mixer");
        } else el.setAttribute("animation-mixer", { timeScale: visible ? 1 : 0, clip: "*", startAt: 0 });
      };
      toggleVisible(model1, false);
      toggleVisible(model2, false);
      toggleVisible(model3, false);
      toggleVisible(model4, false);
      toggleVisible(model5, false);
      target1.addEventListener("targetFound", (event) => {
        toggleVisible(model1, true);
        toggleVisible(model2, false);
        toggleVisible(model3, false);
        toggleVisible(model4, false);
        toggleVisible(model5, false);
      });
      target2.addEventListener("targetFound", (event) => {
        toggleVisible(model2, true);
        toggleVisible(model1, false);
        toggleVisible(model3, false);
        toggleVisible(model4, false);
        toggleVisible(model5, false);
      });
      target3.addEventListener("targetFound", (event) => {
        toggleVisible(model3, true);
        toggleVisible(model1, false);
        toggleVisible(model2, false);
        toggleVisible(model4, false);
        toggleVisible(model5, false);
      });
      target4.addEventListener("targetFound", (event) => {
        toggleVisible(model4, true);
        toggleVisible(model1, false);
        toggleVisible(model2, false);
        toggleVisible(model3, false);
        toggleVisible(model5, false);
      });
      target5.addEventListener("targetFound", (event) => {
        toggleVisible(model5, true);
        toggleVisible(model1, false);
        toggleVisible(model2, false);
        toggleVisible(model3, false);
        toggleVisible(model4, false);
      });
    </script>
  </body>
</html>
